
readme_content = '''# Cert-Print-Agent v3.0

ูุธุงู ุฃุชูุชุฉ ูุนุงูุฌุฉ ุดูุงุฏุงุช ุงููุจูุฏุงุช - Certificate Processing Automation System

## ๐ ูููู ุงููุฌูุฏุงุช / Folder Structure

```
Cert-Print-Agent/
โ
โโโ config.yaml                          # ุฅุนุฏุงุฏุงุช ุงููุธุงู
โโโ main.py                              # ุงูุจุฑูุงูุฌ ุงูุฑุฆูุณู
โโโ quick_start.py                       # ุชุดุบูู ุณุฑูุน
โโโ test_system.py                       # ุงุฎุชุจุงุฑ ุงููุธุงู
โโโ requirements.txt                     # ุงููุชุทูุจุงุช
โ
โโโ logs/                                # ุณุฌูุงุช ุงูุนูููุงุช
โ   โโโ processing.log
โ
โโโ GetCertAgent/
โ   โโโ Source_Cert/                     # ุฃุตูู ุงูุดูุงุฏุงุช (ุฃุฑุดูู)
โ   โโโ Annotated_Certificates/          # ุงูุดูุงุฏุงุช ุงูููุชูุจ ุนูููุง
โ   โโโ Printed_Annotated_Cert/          # ุงูุดูุงุฏุงุช ุงููุทุจูุนุฉ
โ   โโโ MyEmails/                        # ุงูุจุฑูุฏ ุงููุญููุธ (.eml)
โ   โโโ Cert_Inbox/                      # ุงูุดูุงุฏุงุช ุงููุงุฑุฏุฉ ูููุนุงูุฌุฉ
โ   โโโ Processed/                       # ูุฌูุฏ ุงููุนุงูุฌุฉ (ูุฏูู)
โ   โโโ TempImages/                      # ุตูุฑ ูุคูุชุฉ ูููOCR
โ
โโโ Agents/                              # ูููุงุก ุงููุนุงูุฌุฉ
โ   โโโ OutlookAgent.py                  # ูุฑุงูุจุฉ ุงูุจุฑูุฏ
โ   โโโ ExtractLotAgent.py               # ุงุณุชุฎุฑุงุฌ ุฃุฑูุงู ุงูููุช OCR
โ   โโโ ERPAgent.py                      # ุงูุจุญุซ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
โ   โโโ AnnotatePrintAgent.py            # ุงููุชุงุจุฉ ูุงูุทุจุงุนุฉ
โ   โโโ LoggingAgent.py                  # ุงูุชุณุฌูู
โ
โโโ Data/                                # ุงูุจูุงูุงุช
โ   โโโ Raw_Warehouses.xlsx              # ููู ERP
โ
โโโ Tesseract/ + Poppler/                # ููุชุจุงุช OCR
```

## ๐ ุงูุชุดุบูู ุงูุณุฑูุน / Quick Start

### 1. ุงูุชุซุจูุช / Installation

```bash
# ุชุซุจูุช ุงูููุชุจุงุช
pip install -r requirements.txt

# ุชุซุจูุช Tesseract (Windows)
# ุญูู ูู: https://github.com/UB-Mannheim/tesseract/wiki
# ุถุน ูู ูุฌูุฏ Tesseract/

# ุชุซุจูุช Poppler (Windows)
# ุญูู ูู: https://github.com/oschwartz10612/poppler-windows/releases
# ุถุน ูู ูุฌูุฏ Poppler/
```

### 2. ุงูุงุฎุชุจุงุฑ / Testing

```bash
# ุงุฎุชุจุงุฑ ุฌููุน ุงูููููุงุช
python test_system.py
```

### 3. ุงูุชุดุบูู / Running

```bash
# ุชุดุบูู ุฏูุฑุฉ ูุงุญุฏุฉ ููุฑุงู
python quick_start.py

# ุฃู ูุน ูุฑุงูุจุฉ Outlook
python quick_start.py --with-outlook

# ุชุดุบูู ูุณุชูุฑ (ูู 5 ุฏูุงุฆู)
python main.py

# ุชุดุบูู ุฏูุฑุฉ ูุงุญุฏุฉ
python main.py --once
```

## ๐ ุณูุฑ ุงูุนูู / Workflow

```
โโโโโโโโโโโโโโโโโโโ
โ  Outlook Email  โ
โ  (Certificate)  โ
โโโโโโโโโโฌโโโโโโโโโ
         โ
         โผ
โโโโโโโโโโโโโโโโโโโ
โ  Cert_Inbox/    โ
โ  (PDF/JPG)      โ
โโโโโโโโโโฌโโโโโโโโโ
         โ
         โผ
โโโโโโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโโโโ
โ ExtractLotAgent โโโโโโถโ   OCR (Tesseract)โ
โ                 โ     โโโโโโโโโโฌโโโโโโโโโ
โ  - Lot Numbers  โ              โ
โ  - Cert Number  โ              โผ
โ  - Product Name โ     โโโโโโโโโโโโโโโโโโโ
โโโโโโโโโโฌโโโโโโโโโ     โ  Text Extractionโ
         โ              โโโโโโโโโโโโโโโโโโโ
         โผ
โโโโโโโโโโโโโโโโโโโ
โ   ERPAgent      โ
โ                 โ
โ  Search Excel:  โ
โ  - 2026 โ 2023  โ
โ  - Supplier     โ
โ  - Internal Lot โ
โโโโโโโโโโฌโโโโโโโโโ
         โ
         โผ
โโโโโโโโโโโโโโโโโโโ
โAnnotatePrintAgentโ
โ                 โ
โ  1. Annotate PDFโ
โ  2. Print       โ
โ  3. Archive     โ
โโโโโโโโโโฌโโโโโโโโโ
         โ
    โโโโโโดโโโโโฌโโโโโโโโโโโโโโ
    โผ         โผ             โผ
Source_Cert  Annotated_  Printed_
(Archive)   Certificates Annotated
```

## ๐ง ุฃููุงุท ุฃุฑูุงู ุงูููุช / Lot Number Patterns

ุงููุธุงู ูุฏุนู ุงูุฃููุงุท ุงูุชุงููุฉ:

| ุงูููุท | ุงููุซุงู | ุงูููุน |
|-------|--------|-------|
| Single | `139385` | ููุช ูุงุญุฏ |
| Explicit Multi | `139912/139913` ุฃู `139912-139913` | ููุชุงู ุตุฑูุญุงู |
| Implicit Multi | `139865/2` ุฃู `139865/3` | ููุช ุถููู (+1, +2) |
| Alphanumeric | `SFP228` | ุฑูุฒ ุฃุจุฌุฏู ุฑููู |
| Dashed | `163-31-03-39-2394` | ุฃุฑูุงู ููุตููุฉ |

## ๐ ูุตูุต ุงูุชุฐููู / Annotation Text

| ุงูุญุงูุฉ | ูุซุงู |
|--------|------|
| ููุช ูุงุญุฏ | `ุจุงุณู ุญูุง - ููุท 2601` |
| ููุชุงู (ููุณ ุงูููุฑุฏ) | `ูุตุฑู ูุณููู - ููุท 2607 - ููุท 2608` |
| ููุช ุถููู | `ูุงูุฑ ุณุนุฏ - ููุท 2605 +1` |
| ููุฑุฏูู ูุฎุชูููู | `ุจุงุณู ุญูุง: ููุท 2601 \| ูุตุฑู ูุณููู: ููุท 2607` |
| ุบูุฑ ููุฌูุฏ | `ุบูุฑ ูุณุฌู ูู ุงููุธุงู / Not in ERP` |

## โ๏ธ ุงูุฅุนุฏุงุฏุงุช / Configuration

### `config.yaml`

```yaml
paths:
  base_dir: "Cert-Print-Agent"
  source_cert: "GetCertAgent/Source_Cert"
  annotated_cert: "GetCertAgent/Annotated_Certificates"
  printed_cert: "GetCertAgent/Printed_Annotated_Cert"
  cert_inbox: "GetCertAgent/Cert_Inbox"

printing:
  printer_name: "HP Neverstop Laser 100x PCLm-S"
  retry_attempts: 3
  annotation:
    position_x: 50
    position_y: 750  # ุฃุณูู ุงูุตูุญุฉ

ocr:
  language: "eng"
  dpi: 300
```

## ๐ ููู ERP / Excel Structure

**Raw_Warehouses.xlsx** ูุญุชูู ุนูู 4 ุดูุชุงุช:
- `2026` - ุฃุญุฏุซ ุงูุจูุงูุงุช
- `2025`
- `2024`
- `2023`

**ุงูุฃุนูุฏุฉ ุงููุทููุจุฉ:**
- `NO` - ุฑูู ุงูููุช ูู ุงูุดูุงุฏุฉ
- `Lot Num.` - ุฑูู ุงูููุช ุงูุฏุงุฎูู
- `Supplier` - ุงุณู ุงูููุฑุฏ

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก / Troubleshooting

### ูุดููุฉ: OCR ูุง ูุนูู
```bash
# ุชุฃูุฏ ูู ุชุซุจูุช Tesseract
tesseract --version

# ุชุฃูุฏ ูู ุงููุณุงุฑ ูู config.yaml
paths:
  tesseract_path: "Tesseract/tesseract.exe"
```

### ูุดููุฉ: ูุง ูุฌุฏ ููู Excel
```bash
# ุชุฃูุฏ ูู ูุฌูุฏ ุงูููู
Cert-Print-Agent/Data/Raw_Warehouses.xlsx
```

### ูุดููุฉ: ุงูุทุงุจุนุฉ ุบูุฑ ูุชุตูุฉ
```bash
# ุงููุธุงู ุณูุญูุธ ุงููููุงุช ูู Annotated_Certificates/
# ููุนูุฏ ุงููุญุงููุฉ ุชููุงุฆูุงู
```

### ูุดููุฉ: Outlook ูุง ูุณุชุฌูุจ
- ุชุฃูุฏ ูู ูุชุญ Outlook
- ุชุฃูุฏ ูู ุตูุงุญูุงุช ุงููุตูู
- ุฌุฑุจ `outlook_autostart: true` ูู ุงูุฅุนุฏุงุฏุงุช

## ๐ง ุฏุนู ุงููุบุฉ ุงูุนุฑุจูุฉ / Arabic Support

ุงููุธุงู ูุฏุนู:
- ุฃุณูุงุก ุงูููุฑุฏูู ุงูุนุฑุจูุฉ ูู ERP
- ูุชุงุจุฉ ุงููุตูุต ุงูุนุฑุจูุฉ ุนูู PDF
- ุชุณุฌูู ุงูุณุฌูุงุช ุจุงูุนุฑุจูุฉ

**ููุงุญุธุฉ:** ุชุฃูุฏ ูู ูุฌูุฏ ุฎุท ุนุฑุจู ูู Windows:
- `C:/Windows/Fonts/arial.ttf`
- `C:/Windows/Fonts/tahoma.ttf`

## ๐ ุงูุฅุญุตุงุฆูุงุช / Statistics

ุงููุธุงู ูุณุฌู:
- ุนุฏุฏ ุงูุดูุงุฏุงุช ุงููุนุงูุฌุฉ
- ูุณุจุฉ ุงููุฌุงุญ
- ุงูุฃุฎุทุงุก ูุงููุดุงูู
- ููุช ุงููุนุงูุฌุฉ

**ุนุฑุถ ุงูุณุฌูุงุช:**
```bash
# ุขุฎุฑ 50 ุณุทุฑ
Get-Content logs/processing.log -Tail 50

# ุงูุจุญุซ ุนู ุฃุฎุทุงุก
Select-String "ERROR" logs/processing.log
```

## ๐ก๏ธ ุงูุฃูุงู / Security

- ูุงุนุฏุฉ ุจูุงูุงุช SQLite ูููุน ุงููุนุงูุฌุฉ ุงูููุฑุฑุฉ
- ุฃุฑุดูู ูุฌููุน ุงูุดูุงุฏุงุช ุงูุฃุตููุฉ
- ูุณุฎ ุงุญุชูุงุทู ุชููุงุฆู

## ๐ ุงูุฏุนู / Support

ูููุดุงูู ุฃู ุงูุงูุชุฑุงุญุงุช:
1. ุฑุงุฌุน ุณุฌูุงุช ุงูุฃุฎุทุงุก ูู `logs/`
2. ุดุบู `python test_system.py`
3. ุชุฃูุฏ ูู ุฅุนุฏุงุฏุงุช `config.yaml`

---

**ุงูุฅุตุฏุงุฑ:** 3.0  
**ุขุฎุฑ ุชุญุฏูุซ:** 2024



# ุฏููู ุงูุชุญุฏูุซ - Cert-Print-Agent v3.2

## ุงูุชุบููุฑุงุช ุงูุฑุฆูุณูุฉ:

### 1. PDFtoImageAgent.py (ูุญุณูู)
- **ุฅุถุงูุฉ**: ุงุณุชุฎุฑุงุฌ ุงููุต ุงููุจุงุดุฑ ูู PDF ุจุฏูู OCR (ุจุงุณุชุฎุฏุงู PyMuPDF)
- **ุฅุถุงูุฉ**: Preprocessing ููุตูุฑ (ุชุญุณูู ุงูุชุจุงููุ ุฅุฒุงูุฉ ุงูุชุดููุด)
- **ุชุญุณูู**: ุฏุนู Arabic + English ูู OCR
- **ุงูููุทู**: 
  - ุฃููุงู: ูุญุงูู ุงุณุชุฎุฑุงุฌ ุงููุต ูุจุงุดุฑุฉ (ูู PDF ููู ูุต)
  - ูู ูุดู: ูุณุชุฎุฏู OCR ุนูู ุงูุตูุฑ

### 2. JSONExtractLotAgent.py (ูุญุณูู)
- **ุชุญุณูู**: Pattern matching ูุฑู ูุชุญูู:
  - ุฃุฎุทุงุก OCR (l0t ุจุฏู lot)
  - ูุณุงูุงุช ุฒุงุฆุฏุฉ
  - ุฃุดูุงู ูุฎุชููุฉ ูู "Lot Number"
- **ุฅุถุงูุฉ**: ุงูุจุญุซ ุจุงูุณูุงู (Context-based) ูู ุงูู pattern ุงูุชูููุฏู ูุดู
- **ุฅุถุงูุฉ**: ุฏุนู ุงุณุชุฎุฑุงุฌ ุฑูู ุงูุดูุงุฏุฉ ูุงูููุชุฌ

### 3. main_v3.py
- ููุณ ุงูููุทู ุจุณ ูุน ุชุญุฏูุซ ุฑูู ุงูุฅุตุฏุงุฑ

## ุฎุทูุงุช ุงูุชุญุฏูุซ:

```bash
# 1. ุงุญูุธ ุงููููุงุช ุงููุฏููุฉ (ุงุญุชูุงุทู)
cd "D:\\My Projects\\Cert-Print-Agent"
mkdir backup
copy Agents\\PDFtoImageAgent.py backup\\
copy Agents\\JSONExtractLotAgent.py backup\\

# 2. ุงุณุชุจุฏู ุงููููุงุช ุจุงูุฅุตุฏุงุฑุงุช ุงูุฌุฏูุฏุฉ
# ุงูุณุฎ ุงููููุงุช ูู /mnt/kimi/output/ ุฅูู ุงููุฌูุฏ ุงูููุงุณุจ

# 3. ุซุจูุช PyMuPDF (ูุทููุจ ููุงุณุชุฎุฑุงุฌ ุงููุจุงุดุฑ)
pip install pymupdf

# 4. ุงุฎุชุจุงุฑ
python test_extraction.py

# 5. ุชุดุบูู ูุงูู
python main_v3.py --stage1-only
python main_v3.py --stage2-only
```

## ุงุฎุชุจุงุฑ ุณุฑูุน:

```bash
# ุงุฎุชุจุงุฑ ููู ูุงุญุฏ
python test_extraction.py "GetCertAgent/Cert_Inbox/Basil 139928.pdf"

# ุงุฎุชุจุงุฑ ูู ุงููููุงุช
python test_extraction.py
```

## ูู ุงูู Arabic OCR ูุด ุดุบุงู:

1. ูุฒู ูููุงุช ุงููุบุฉ ุงูุนุฑุจูุฉ ูู Tesseract:
   - ูู: https://github.com/UB-Mannheim/tesseract/wiki
   - ุฃู ุดุบู: `tesseract --list-langs` ูุชุฃูุฏ ุฅู "ara" ููุฌูุฏ

2. ูู "ara" ูุด ููุฌูุฏุ ุซุจุชู:
   ```bash
   # Windows: ุญูู ูู ููุง
   https://github.com/UB-Mannheim/tesseract/wiki
   
   # ุถุน ุงููููุงุช ูู: Tesseract/tessdata/ara.traineddata
   ```

3. ูู ูููุด Arabic ุฎุงูุตุ ุงููุธุงู ููุดุชุบู ุจู English ุจุณ ูุน ุงูู pattern matching ุงููุญุณูู

## ููุงุญุธุงุช:

- **ุงูุงุณุชุฎุฑุงุฌ ุงููุจุงุดุฑ** (ุจุฏูู OCR) ุฃุณุฑุน ูุฃุฏู ุจูุชูุฑ
- **ุงูู Preprocessing** ุจูุญุณู ุฏูุฉ OCR ูู ุงุถุทุฑููุง ูุณุชุฎุฏูู
- **Pattern matching ุงููุฑู** ุจููุฏุฑ ููุงูู ุงูููุช ุญุชู ูู ููู ุฃุฎุทุงุก ูู OCR

